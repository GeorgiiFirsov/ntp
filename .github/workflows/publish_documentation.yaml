name: Publish documentation

on:
    push:
        branches:
            - 'main'

jobs:
    deploy:
        runs-on: ubuntu-latest

        steps:
            - name: Checkout repository
              uses: actions/checkout@v3
              with:
                fetch-depth: 0
                submodules: 'recursive'
            
            - name: Configure Doxygen with CMake
              run: cmake . -DNTP_ENABLE_GH_DOCS_ONLY=ON

            - name: Checking content of docs
              run: ls docs/

            - name: Checking content of docs/doxygen-awesome-css
              run: ls docs/doxygen-awesome-css/

            - name: Generate Documentation
              uses: mattnotmitt/doxygen-action@v1.9.4
              with:
                working-directory: docs/

            - name: Publish generated content to GitHub Pages
              uses: JamesIves/github-pages-deploy-action@v4
              with:
                folder: docs/doxygen/html
                token: ${{ secrets.ACCESS_TOKEN }}
